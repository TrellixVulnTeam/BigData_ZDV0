Using TensorFlow backend.
WARNING:tensorflow:From /users/madanraj/BigData-master/code/lstm_rnn_dynamic.py:83: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/tensor_array_ops.py:162: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /users/madanraj/BigData-master/code/lstm_rnn_dynamic.py:89: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.batch_normalization instead.
2019-05-09 23:04:37.107030: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2019-05-09 23:04:37.118575: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2194835000 Hz
2019-05-09 23:04:37.121698: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x6c97110 executing computations on platform Host. Devices:
2019-05-09 23:04:37.121742: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
('backend', u'tensorflow')
((240000, 784), (240000, 1), (40000, 784), (40000, 1))
((240000, 28, 28), (240000, 1), (40000, 28, 28), (40000, 1))
((240000, 28, 28), (240000, 1), (40000, 28, 28), (40000, 1))

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

dense/kernel:0
dense/bias:0
Step 10, Minibatch Loss= 2.2951, Training Accuracy= 0.125
Step 20, Minibatch Loss= 2.2955, Training Accuracy= 0.133
Step 30, Minibatch Loss= 2.2965, Training Accuracy= 0.078
Step 40, Minibatch Loss= 2.2928, Training Accuracy= 0.141
Step 50, Minibatch Loss= 2.2888, Training Accuracy= 0.148
Step 60, Minibatch Loss= 2.2855, Training Accuracy= 0.164
Step 70, Minibatch Loss= 2.2795, Training Accuracy= 0.203
Step 80, Minibatch Loss= 2.2636, Training Accuracy= 0.180
Step 90, Minibatch Loss= 2.2313, Training Accuracy= 0.250
Step 100, Minibatch Loss= 2.1375, Training Accuracy= 0.383
Step 110, Minibatch Loss= 1.8785, Training Accuracy= 0.344
Step 120, Minibatch Loss= 1.6789, Training Accuracy= 0.539
Step 130, Minibatch Loss= 1.4900, Training Accuracy= 0.547
Step 140, Minibatch Loss= 1.3019, Training Accuracy= 0.602
Step 150, Minibatch Loss= 1.0936, Training Accuracy= 0.672
Step 160, Minibatch Loss= 0.8422, Training Accuracy= 0.805
Step 170, Minibatch Loss= 0.7909, Training Accuracy= 0.734
Step 180, Minibatch Loss= 0.7198, Training Accuracy= 0.805
Step 190, Minibatch Loss= 0.5207, Training Accuracy= 0.875
Step 200, Minibatch Loss= 0.6162, Training Accuracy= 0.805
Step 210, Minibatch Loss= 0.4366, Training Accuracy= 0.875
Step 220, Minibatch Loss= 0.4750, Training Accuracy= 0.844
Step 230, Minibatch Loss= 0.4267, Training Accuracy= 0.875
Step 240, Minibatch Loss= 0.4134, Training Accuracy= 0.844
Step 250, Minibatch Loss= 0.4694, Training Accuracy= 0.852
Step 260, Minibatch Loss= 0.3273, Training Accuracy= 0.891
Step 270, Minibatch Loss= 0.3108, Training Accuracy= 0.914
Step 280, Minibatch Loss= 0.3531, Training Accuracy= 0.914
Step 290, Minibatch Loss= 0.3677, Training Accuracy= 0.867
Step 300, Minibatch Loss= 0.2425, Training Accuracy= 0.930
Step 310, Minibatch Loss= 0.3466, Training Accuracy= 0.883
Step 320, Minibatch Loss= 0.2445, Training Accuracy= 0.906
Step 330, Minibatch Loss= 0.1623, Training Accuracy= 0.961
Step 340, Minibatch Loss= 0.3070, Training Accuracy= 0.922
Step 350, Minibatch Loss= 0.3593, Training Accuracy= 0.930
Step 360, Minibatch Loss= 0.3547, Training Accuracy= 0.898
Step 370, Minibatch Loss= 0.2960, Training Accuracy= 0.922
Step 380, Minibatch Loss= 0.2680, Training Accuracy= 0.938
Step 390, Minibatch Loss= 0.2468, Training Accuracy= 0.938
Step 400, Minibatch Loss= 0.1860, Training Accuracy= 0.953
Step 410, Minibatch Loss= 0.2254, Training Accuracy= 0.930
Step 420, Minibatch Loss= 0.1782, Training Accuracy= 0.961
Step 430, Minibatch Loss= 0.1565, Training Accuracy= 0.969
Step 440, Minibatch Loss= 0.1211, Training Accuracy= 0.969
Step 450, Minibatch Loss= 0.1038, Training Accuracy= 0.969
Step 460, Minibatch Loss= 0.1798, Training Accuracy= 0.953
Optimization Finished!
Step 10, Minibatch Loss= 0.1525, Training Accuracy= 0.953
Step 20, Minibatch Loss= 0.1546, Training Accuracy= 0.953
Step 30, Minibatch Loss= 0.0930, Training Accuracy= 0.984
Step 40, Minibatch Loss= 0.0930, Training Accuracy= 0.969
Step 50, Minibatch Loss= 0.0838, Training Accuracy= 0.984
Step 60, Minibatch Loss= 0.1425, Training Accuracy= 0.945
Step 70, Minibatch Loss= 0.1242, Training Accuracy= 0.961
Step 80, Minibatch Loss= 0.0936, Training Accuracy= 0.977
Step 90, Minibatch Loss= 0.1309, Training Accuracy= 0.961
Step 100, Minibatch Loss= 0.0879, Training Accuracy= 0.977
Step 110, Minibatch Loss= 0.0464, Training Accuracy= 0.992
Step 120, Minibatch Loss= 0.0494, Training Accuracy= 0.992
Step 130, Minibatch Loss= 0.2022, Training Accuracy= 0.930
Step 140, Minibatch Loss= 0.1648, Training Accuracy= 0.961
Step 150, Minibatch Loss= 0.0620, Training Accuracy= 0.992
Step 160, Minibatch Loss= 0.0617, Training Accuracy= 0.984
Step 170, Minibatch Loss= 0.1002, Training Accuracy= 0.977
Step 180, Minibatch Loss= 0.0929, Training Accuracy= 0.969
Step 190, Minibatch Loss= 0.0585, Training Accuracy= 0.977
Step 200, Minibatch Loss= 0.0859, Training Accuracy= 0.984
Step 210, Minibatch Loss= 0.0478, Training Accuracy= 0.992
Step 220, Minibatch Loss= 0.0442, Training Accuracy= 0.992
Step 230, Minibatch Loss= 0.0533, Training Accuracy= 0.984
Step 240, Minibatch Loss= 0.0401, Training Accuracy= 0.984
Step 250, Minibatch Loss= 0.0389, Training Accuracy= 1.000
Step 260, Minibatch Loss= 0.0833, Training Accuracy= 0.992
Step 270, Minibatch Loss= 0.0262, Training Accuracy= 1.000
Step 280, Minibatch Loss= 0.1406, Training Accuracy= 0.969
Step 290, Minibatch Loss= 0.0678, Training Accuracy= 0.992
Step 300, Minibatch Loss= 0.0440, Training Accuracy= 0.992
Step 310, Minibatch Loss= 0.0401, Training Accuracy= 0.992
Step 320, Minibatch Loss= 0.0879, Training Accuracy= 0.984
Step 330, Minibatch Loss= 0.0437, Training Accuracy= 0.992
Step 340, Minibatch Loss= 0.1112, Training Accuracy= 0.969
Step 350, Minibatch Loss= 0.1654, Training Accuracy= 0.953
Step 360, Minibatch Loss= 0.0901, Training Accuracy= 0.984
Step 370, Minibatch Loss= 0.0348, Training Accuracy= 0.992
Step 380, Minibatch Loss= 0.1122, Training Accuracy= 0.977
Step 390, Minibatch Loss= 0.0286, Training Accuracy= 1.000
Step 400, Minibatch Loss= 0.0736, Training Accuracy= 0.984
Step 410, Minibatch Loss= 0.0910, Training Accuracy= 0.992
Step 420, Minibatch Loss= 0.0404, Training Accuracy= 0.992
Step 430, Minibatch Loss= 0.0409, Training Accuracy= 0.992
Step 440, Minibatch Loss= 0.0331, Training Accuracy= 1.000
Step 450, Minibatch Loss= 0.0186, Training Accuracy= 1.000
Step 460, Minibatch Loss= 0.0597, Training Accuracy= 0.977
Optimization Finished!
Step 10, Minibatch Loss= 0.0330, Training Accuracy= 0.992
Step 20, Minibatch Loss= 0.0343, Training Accuracy= 0.992
Step 30, Minibatch Loss= 0.0261, Training Accuracy= 1.000
Step 40, Minibatch Loss= 0.0231, Training Accuracy= 0.992
Step 50, Minibatch Loss= 0.0302, Training Accuracy= 0.992
Step 60, Minibatch Loss= 0.0255, Training Accuracy= 1.000
Step 70, Minibatch Loss= 0.1160, Training Accuracy= 0.977
Step 80, Minibatch Loss= 0.0348, Training Accuracy= 0.992
Step 90, Minibatch Loss= 0.0664, Training Accuracy= 0.984
Step 100, Minibatch Loss= 0.0189, Training Accuracy= 1.000
Step 110, Minibatch Loss= 0.0167, Training Accuracy= 0.992
Step 120, Minibatch Loss= 0.0236, Training Accuracy= 0.992
Step 130, Minibatch Loss= 0.0821, Training Accuracy= 0.977
Step 140, Minibatch Loss= 0.1086, Training Accuracy= 0.984
Step 150, Minibatch Loss= 0.0188, Training Accuracy= 1.000
Step 160, Minibatch Loss= 0.0225, Training Accuracy= 0.992
Step 170, Minibatch Loss= 0.0368, Training Accuracy= 0.992
Step 180, Minibatch Loss= 0.0462, Training Accuracy= 0.992
Step 190, Minibatch Loss= 0.0197, Training Accuracy= 1.000
Step 200, Minibatch Loss= 0.0410, Training Accuracy= 0.984
Step 210, Minibatch Loss= 0.0421, Training Accuracy= 0.984
Step 220, Minibatch Loss= 0.0160, Training Accuracy= 1.000
Step 230, Minibatch Loss= 0.0083, Training Accuracy= 1.000
Step 240, Minibatch Loss= 0.0227, Training Accuracy= 0.992
Step 250, Minibatch Loss= 0.0167, Training Accuracy= 1.000
Step 260, Minibatch Loss= 0.0995, Training Accuracy= 0.977
Step 270, Minibatch Loss= 0.0087, Training Accuracy= 1.000
Step 280, Minibatch Loss= 0.0469, Training Accuracy= 0.984
Step 290, Minibatch Loss= 0.0329, Training Accuracy= 0.992
Step 300, Minibatch Loss= 0.0173, Training Accuracy= 1.000
Step 310, Minibatch Loss= 0.0140, Training Accuracy= 1.000
Step 320, Minibatch Loss= 0.0494, Training Accuracy= 0.992
Step 330, Minibatch Loss= 0.0077, Training Accuracy= 1.000
Step 340, Minibatch Loss= 0.0640, Training Accuracy= 0.984
Step 350, Minibatch Loss= 0.0998, Training Accuracy= 0.969
Step 360, Minibatch Loss= 0.0260, Training Accuracy= 0.992
Step 370, Minibatch Loss= 0.0863, Training Accuracy= 0.977
Step 380, Minibatch Loss= 0.0641, Training Accuracy= 0.984
Step 390, Minibatch Loss= 0.0164, Training Accuracy= 1.000
Step 400, Minibatch Loss= 0.0462, Training Accuracy= 0.992
Step 410, Minibatch Loss= 0.0658, Training Accuracy= 0.984
Step 420, Minibatch Loss= 0.0188, Training Accuracy= 0.992
Step 430, Minibatch Loss= 0.0189, Training Accuracy= 1.000
Step 440, Minibatch Loss= 0.0200, Training Accuracy= 1.000
Step 450, Minibatch Loss= 0.0066, Training Accuracy= 1.000
Step 460, Minibatch Loss= 0.0391, Training Accuracy= 0.977
Optimization Finished!
Step 10, Minibatch Loss= 0.0223, Training Accuracy= 0.992
Step 20, Minibatch Loss= 0.0137, Training Accuracy= 1.000
Step 30, Minibatch Loss= 0.0122, Training Accuracy= 1.000
Step 40, Minibatch Loss= 0.0079, Training Accuracy= 1.000
Step 50, Minibatch Loss= 0.0165, Training Accuracy= 0.992
Step 60, Minibatch Loss= 0.0095, Training Accuracy= 1.000
Step 70, Minibatch Loss= 0.0156, Training Accuracy= 0.992
Step 80, Minibatch Loss= 0.0298, Training Accuracy= 0.984
Step 90, Minibatch Loss= 0.0204, Training Accuracy= 1.000
Step 100, Minibatch Loss= 0.0073, Training Accuracy= 1.000
Step 110, Minibatch Loss= 0.0057, Training Accuracy= 1.000
Step 120, Minibatch Loss= 0.0289, Training Accuracy= 0.984
Step 130, Minibatch Loss= 0.0380, Training Accuracy= 0.992
Step 140, Minibatch Loss= 0.0738, Training Accuracy= 0.977
Step 150, Minibatch Loss= 0.0106, Training Accuracy= 1.000
Step 160, Minibatch Loss= 0.0297, Training Accuracy= 0.984
Step 170, Minibatch Loss= 0.0270, Training Accuracy= 0.992
Step 180, Minibatch Loss= 0.0179, Training Accuracy= 1.000
Step 190, Minibatch Loss= 0.0181, Training Accuracy= 0.992
Step 200, Minibatch Loss= 0.0192, Training Accuracy= 1.000
Step 210, Minibatch Loss= 0.0374, Training Accuracy= 0.992
Step 220, Minibatch Loss= 0.0109, Training Accuracy= 1.000
Step 230, Minibatch Loss= 0.0052, Training Accuracy= 1.000
Step 240, Minibatch Loss= 0.0331, Training Accuracy= 0.984
Step 250, Minibatch Loss= 0.0128, Training Accuracy= 1.000
Step 260, Minibatch Loss= 0.1052, Training Accuracy= 0.961
Step 270, Minibatch Loss= 0.0113, Training Accuracy= 1.000
Step 280, Minibatch Loss= 0.0304, Training Accuracy= 0.992
Step 290, Minibatch Loss= 0.0116, Training Accuracy= 1.000
Step 300, Minibatch Loss= 0.0115, Training Accuracy= 1.000
Step 310, Minibatch Loss= 0.0129, Training Accuracy= 1.000
Step 320, Minibatch Loss= 0.0430, Training Accuracy= 0.992
Step 330, Minibatch Loss= 0.0056, Training Accuracy= 1.000
Step 340, Minibatch Loss= 0.0406, Training Accuracy= 0.984
Step 350, Minibatch Loss= 0.0422, Training Accuracy= 0.977
Step 360, Minibatch Loss= 0.0261, Training Accuracy= 0.984
Step 370, Minibatch Loss= 0.0705, Training Accuracy= 0.984
Step 380, Minibatch Loss= 0.0522, Training Accuracy= 0.984
Step 390, Minibatch Loss= 0.0082, Training Accuracy= 1.000
Step 400, Minibatch Loss= 0.0134, Training Accuracy= 1.000
Step 410, Minibatch Loss= 0.0380, Training Accuracy= 0.992
Step 420, Minibatch Loss= 0.0079, Training Accuracy= 1.000
Step 430, Minibatch Loss= 0.0094, Training Accuracy= 1.000
Step 440, Minibatch Loss= 0.0111, Training Accuracy= 1.000
Step 450, Minibatch Loss= 0.0045, Training Accuracy= 1.000
Step 460, Minibatch Loss= 0.0078, Training Accuracy= 1.000
Optimization Finished!
Step 10, Minibatch Loss= 0.0069, Training Accuracy= 1.000
Step 20, Minibatch Loss= 0.0138, Training Accuracy= 1.000
Step 30, Minibatch Loss= 0.0064, Training Accuracy= 1.000
Step 40, Minibatch Loss= 0.0048, Training Accuracy= 1.000
Step 50, Minibatch Loss= 0.0109, Training Accuracy= 1.000
Step 60, Minibatch Loss= 0.0070, Training Accuracy= 1.000
Step 70, Minibatch Loss= 0.0146, Training Accuracy= 0.992
Step 80, Minibatch Loss= 0.0088, Training Accuracy= 1.000
Step 90, Minibatch Loss= 0.0076, Training Accuracy= 1.000
Step 100, Minibatch Loss= 0.0036, Training Accuracy= 1.000
Step 110, Minibatch Loss= 0.0033, Training Accuracy= 1.000
Step 120, Minibatch Loss= 0.0224, Training Accuracy= 0.992
Step 130, Minibatch Loss= 0.0236, Training Accuracy= 1.000
Step 140, Minibatch Loss= 0.0386, Training Accuracy= 0.992
Step 150, Minibatch Loss= 0.0066, Training Accuracy= 1.000
Step 160, Minibatch Loss= 0.0084, Training Accuracy= 1.000
Step 170, Minibatch Loss= 0.0255, Training Accuracy= 0.984
Step 180, Minibatch Loss= 0.0160, Training Accuracy= 0.992
Step 190, Minibatch Loss= 0.0177, Training Accuracy= 0.992
Step 200, Minibatch Loss= 0.0122, Training Accuracy= 1.000
Step 210, Minibatch Loss= 0.0360, Training Accuracy= 0.992
Step 220, Minibatch Loss= 0.0097, Training Accuracy= 1.000
Step 230, Minibatch Loss= 0.0037, Training Accuracy= 1.000
Step 240, Minibatch Loss= 0.0235, Training Accuracy= 0.992
Step 250, Minibatch Loss= 0.0153, Training Accuracy= 1.000
Step 260, Minibatch Loss= 0.0048, Training Accuracy= 1.000
Step 270, Minibatch Loss= 0.0082, Training Accuracy= 1.000
Step 280, Minibatch Loss= 0.0195, Training Accuracy= 0.984
Step 290, Minibatch Loss= 0.0095, Training Accuracy= 1.000
Step 300, Minibatch Loss= 0.0064, Training Accuracy= 1.000
Step 310, Minibatch Loss= 0.0085, Training Accuracy= 1.000
Step 320, Minibatch Loss= 0.0441, Training Accuracy= 0.992
Step 330, Minibatch Loss= 0.0050, Training Accuracy= 1.000
Step 340, Minibatch Loss= 0.0202, Training Accuracy= 0.992
Step 350, Minibatch Loss= 0.0160, Training Accuracy= 1.000
Step 360, Minibatch Loss= 0.0125, Training Accuracy= 1.000
Step 370, Minibatch Loss= 0.0282, Training Accuracy= 0.992
Step 380, Minibatch Loss= 0.0441, Training Accuracy= 0.984
Step 390, Minibatch Loss= 0.0056, Training Accuracy= 1.000
Step 400, Minibatch Loss= 0.0173, Training Accuracy= 0.992
Step 410, Minibatch Loss= 0.0389, Training Accuracy= 0.992
Step 420, Minibatch Loss= 0.0035, Training Accuracy= 1.000
Step 430, Minibatch Loss= 0.0084, Training Accuracy= 1.000
Step 440, Minibatch Loss= 0.0088, Training Accuracy= 1.000
Step 450, Minibatch Loss= 0.0037, Training Accuracy= 1.000
Step 460, Minibatch Loss= 0.0056, Training Accuracy= 1.000
Optimization Finished!
('Testing Accuracy:', 0.982225)
